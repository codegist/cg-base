<link href="../polymer/polymer.html" rel="import">

<polymer-element name="cg-base" attributes="dataTagPrefix dataBaseParams">
<script>
  Polymer({
      dataTagPrefix:null,
      dataBaseParams:null,
      created:function(){
          Polymer.addEventListener(document, "cg-application-event", function(e){
              this.onApplicationEvent(event.detail.type, event.detail, e);
          }.bind(this));
      },
      fireApplicationEvent:function(type, params){
          console.log("[cg-base] fireApplicationEvent(type:"+type+", params:"+String(JSON.stringify(params)).substr(0, 40)+")");
          this.asyncFire("cg-application-event", {
              type:type,
              params:params,
              source:this
          }, document);
      },
      fireDataRequest:function(type, callback, params){
          type = this.dataTagPrefix ? this.dataTagPrefix + "-" + type : type;
          params = Polymer.mixin({}, params || {}, this.dataBaseParams)
          console.log("[cg-base] fireDataRequest(type:"+type+", params:"+String(JSON.stringify(params)).substr(0, 40)+")");
          this.asyncFire("data-request", {
              type:type,
              params:params,
              source:this,
              callback:callback || this.onDataReady
          }, document);
      },
      isDataAware:function(){
          return (this.dataTagPrefix !== undefined && this.dataTagPrefix !== null)
                  || (this.dataBaseParams !== undefined && this.dataBaseParams !== null);
      },
      dataBaseParamsChanged:function(){
          this.onRefreshData();
      },
      onRefreshData:function(){

      },
      onDataReady:function(e){
          console.log("DataReady: " + e);
      },
      onApplicationEvent:function(type, event, e){

      }
  });

</script>
</polymer-element>